<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ğŸ¥ Video URL Extractor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <!-- ======== å»£å‘Šä½ï¼ˆç½®é ‚ï¼‰======== -->
  <div style="text-align: center; padding: 10px 0; background: #f8f8f8; border-bottom: 1px solid #ddd;">
    <div id="webtraf_17728" style="display: inline-block; width:468px; height:60px;">
      <script src="https://webtrafic.ru/ads.php?uid=17728" async></script>
    </div>
  </div>
  <!-- ======== å»£å‘ŠçµæŸ ======== -->

  <div class="container">
    <h1>ğŸ¥ Direct Video URL Extractor</h1>
    <input type="url" id="urlInput" placeholder="Paste a video page URL..." autocomplete="off" />
    <button id="extractBtn" onclick="extractLinks()">Extract</button>
    <div id="output" class="output-box" aria-live="polite" aria-atomic="true">Output will appear here...</div>
  </div>

  <script>
    function createLink(url) {
      const a = document.createElement('a');
      a.href = url;
      a.textContent = url;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.className = 'output-link';
      return a;
    }
    function createCopyBtn(linkUrl) {
      const btn = document.createElement('button');
      btn.textContent = 'Copy';
      btn.className = 'copy-btn';
      btn.setAttribute('aria-label', `Copy link ${linkUrl}`);
      btn.onclick = () => {
        navigator.clipboard.writeText(linkUrl).then(() => {
          btn.textContent = 'Copied!';
          setTimeout(() => btn.textContent = 'Copy', 1500);
        });
      };
      return btn;
    }
    async function extractLinks() {
      const url = document.getElementById('urlInput').value.trim();
      const output = document.getElementById('output');
      const btn = document.getElementById('extractBtn');
      if (!url) {
        output.textContent = 'âš ï¸ Please enter a URL.';
        return;
      }
      output.textContent = 'â³ Extracting...';
      btn.disabled = true;
      try {
        const res = await fetch('/extract', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({url})
        });
        const data = await res.json();
        output.innerHTML = ''; // Clear output
        if (data.error) {
          output.textContent = 'âŒ Error: ' + data.error;
        } else if (data.type === 'none') {
          output.textContent = data.message;
        } else {
          const heading = document.createElement('p');
          heading.textContent = `Found ${data.links.length} ${data.type.toUpperCase()} link(s):`;
          heading.className = 'result-heading';
          output.appendChild(heading);
          data.links.forEach(link => {
            const linkWrapper = document.createElement('div');
            linkWrapper.className = 'link-wrapper';
            const a = createLink(link);
            const copyBtn = createCopyBtn(link);
            linkWrapper.appendChild(a);
            linkWrapper.appendChild(copyBtn);
            output.appendChild(linkWrapper);
          });
        }
      } catch (err) {
        output.textContent = 'âŒ Error: ' + err.message;
      } finally {
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>
